<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Opener - Without Saving Number</title>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #25D366;
            --primary-dark: #128C7E;
            --primary-light: #dcf8c6;
            --secondary: #667eea;
            --secondary-dark: #764ba2;
            --accent: #764ba2;
            --dark: #1a202c;
            --dark-light: #2d3748;
            --light: #f7fafc;
            --gray: #a0aec0;
            --gray-light: #e2e8f0;
            --gray-dark: #4a5568;
            --card-bg: rgba(45, 55, 72, 0.95);
            --card-bg-light: rgba(255, 255, 255, 0.95);
            --text: #e2e8f0;
            --text-dark: #2d3748;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --shadow-light: 0 8px 32px rgba(0, 0, 0, 0.1);
            --shadow-card: 0 4px 12px rgba(0, 0, 0, 0.1);
            --error: #e53e3e;
            --success: #38a169;
            --warning: #ed8936;
            --border-radius: 16px;
            --border-radius-sm: 8px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="light"] {
            --card-bg: var(--card-bg-light);
            --text: var(--text-dark);
            --shadow: var(--shadow-light);
            --background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --input-bg: #ffffff;
            --input-border: #e2e8f0;
            --input-text: #2d3748;
        }

        [data-theme="dark"] {
            --background: linear-gradient(135deg, var(--dark) 0%, var(--dark-light) 100%);
            --input-bg: rgba(255, 255, 255, 0.1);
            --input-border: rgba(255, 255, 255, 0.2);
            --input-text: var(--text);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--background);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
            color: var(--text);
            transition: var(--transition);
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
        }

        /* Header Controls */
        .header-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .control-btn {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-sm);
            padding: 12px 15px;
            color: var(--text);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        /* User Profile Row */
        .user-profile-row {
            display: flex;
            align-items: center;
            gap: 15px;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .profile-photo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid var(--primary);
            object-fit: cover;
            background: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-dark);
            font-weight: bold;
            font-size: 20px;
        }

        .profile-info {
            flex: 1;
        }

        .profile-info h3 {
            color: var(--text);
            margin-bottom: 5px;
            font-size: 1.2em;
            font-weight: 600;
        }

        .profile-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9em;
            color: var(--gray);
        }

        .profile-stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .card-header i {
            color: var(--primary);
            font-size: 20px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text);
            font-weight: 600;
            font-size: 0.9em;
        }

        .phone-input, .message-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid var(--input-border);
            border-radius: var(--border-radius-sm);
            font-size: 16px;
            transition: var(--transition);
            background: var(--input-bg);
            color: var(--input-text);
            font-family: inherit;
        }

        .phone-input:focus, .message-input:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--input-bg);
            box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.2);
        }

        .message-input {
            resize: vertical;
            min-height: 120px;
        }

        .char-count {
            text-align: right;
            font-size: 0.8em;
            color: var(--gray);
            margin-top: 5px;
        }

        /* Send Button with Loading - UPDATED DESIGN */
        .send-btn {
            width: 100%;
            padding: 18px 24px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .send-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(37, 211, 102, 0.5);
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
        }

        .send-btn:active {
            transform: translateY(-1px);
        }

        .send-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        .send-btn:hover::before {
            left: 100%;
        }

        .send-btn.loading {
            pointer-events: none;
            opacity: 0.8;
        }

        .send-btn.loading .btn-text {
            visibility: hidden;
        }

        .send-btn.loading::after {
            content: '';
            position: absolute;
            width: 24px;
            height: 24px;
            border: 3px solid transparent;
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* History Section */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            color: var(--text);
            font-size: 1.3em;
            font-weight: 600;
        }

        .reload-btn {
            background: rgba(37, 211, 102, 0.1);
            border: none;
            color: var(--primary);
            cursor: pointer;
            padding: 10px;
            border-radius: 10px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
        }

        .reload-btn:hover {
            background: rgba(37, 211, 102, 0.2);
            transform: rotate(90deg);
        }

        .reload-btn.rotating i {
            animation: rotate 1s linear infinite;
        }

        .history-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: var(--transition);
            border-radius: var(--border-radius-sm);
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.05);
        }

        .history-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .history-info {
            flex: 1;
        }

        .history-number {
            font-weight: 600;
            color: var(--text);
            margin-bottom: 5px;
        }

        .history-date {
            font-size: 0.8em;
            color: var(--gray);
        }

        .history-preview {
            font-size: 0.9em;
            color: var(--gray);
            margin-top: 5px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 200px;
        }

        .detail-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8em;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .detail-btn:hover {
            background: var(--secondary-dark);
            transform: translateY(-2px);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 25px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: modalFadeIn 0.3s ease-out;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-title {
            color: var(--text);
            font-size: 1.4em;
            font-weight: 600;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            font-size: 1.3em;
            color: var(--text);
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 25px;
        }

        .help-step {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border-left: 4px solid var(--secondary);
            transition: var(--transition);
        }

        .help-step:hover {
            transform: translateX(5px);
        }

        .help-step h4 {
            color: var(--primary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .help-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 25px;
        }

        .help-btn {
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
        }

        .help-btn.admin {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .help-btn.group {
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            color: white;
        }

        .help-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* Language Selector - IMPROVED */
        .language-selector {
            position: relative;
        }

        .language-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--card-bg);
            border-radius: 12px;
            margin-top: 5px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: none;
            z-index: 100;
            max-height: 300px;
            overflow-y: auto;
            animation: dropdownSlide 0.3s ease-out;
        }

        .language-dropdown.show {
            display: block;
        }

        .language-option {
            padding: 10px 15px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
        }

        .language-option:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .language-option.active {
            background: rgba(37, 211, 102, 0.2);
            color: var(--primary);
            position: relative;
        }

        .language-option.active::after {
            content: '‚úì';
            position: absolute;
            right: 15px;
            font-weight: bold;
            color: var(--primary);
        }

        .language-flag {
            width: 18px;
            height: 14px;
            border-radius: 2px;
            object-fit: cover;
        }

        /* Animations */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        @keyframes dropdownSlide {
            from {
                opacity: 0;
                transform: translateY(-10px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* Scrollbar */
        .history-list::-webkit-scrollbar {
            width: 6px;
        }

        .history-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .history-list::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            z-index: 3000;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 90%;
            text-align: center;
            font-weight: 500;
            animation: slideUp 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .toast.error {
            background: var(--error);
        }

        .toast.success {
            background: var(--success);
        }

        .toast.warning {
            background: var(--warning);
        }

        @keyframes slideUp {
            from {
                transform: translateX(-50%) translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        /* Loading States */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 20px;
            color: white;
            backdrop-filter: blur(5px);
        }

        .loading-overlay.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .container {
                padding: 0 10px;
            }
            
            .header-controls {
                flex-direction: row;
            }
            
            .control-btn {
                padding: 10px 12px;
                font-size: 12px;
            }
            
            .user-profile-row {
                flex-direction: row;
                text-align: left;
            }
            
            .profile-meta {
                justify-content: flex-start;
            }
            
            .help-buttons {
                grid-template-columns: 1fr;
            }
            
            .card {
                padding: 20px 15px;
            }
            
            .modal-content {
                border-radius: 20px;
            }
            
            .modal-header, .modal-body {
                padding: 20px;
            }
            
            .send-btn {
                padding: 16px 20px;
                font-size: 16px;
            }
            
            .language-option {
                padding: 8px 12px;
                font-size: 12px;
            }
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 20px rgba(37, 211, 102, 0.4);
            cursor: pointer;
            transition: var(--transition);
            z-index: 100;
            border: none;
            animation: pulse 2s infinite;
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(37, 211, 102, 0.6);
            animation: none;
        }

        /* Input with icon */
        .input-with-icon {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .input-with-icon input {
            padding-left: 45px;
        }

        /* Telegram WebApp Fix */
        .telegram-webapp {
            display: none;
        }
    </style>
</head>
<body data-theme="dark">
    <div class="container">
        <!-- Header Controls -->
        <div class="header-controls">
            <!-- Language Selector -->
            <div class="language-selector">
                <button class="control-btn" onclick="app.toggleLanguageDropdown()">
                    <i class="fas fa-language"></i>
                    <span data-i18n="language">Language</span>
                    <i class="fas fa-chevron-down" style="margin-left: auto; font-size: 10px;"></i>
                </button>
                <div id="languageDropdown" class="language-dropdown">
                    <div class="language-option active" data-lang="en" onclick="app.selectLanguage('en')">
                        <span>üá∫üá∏</span>
                        <span>English</span>
                    </div>
                    <div class="language-option" data-lang="bn" onclick="app.selectLanguage('bn')">
                        <span>üáßüá©</span>
                        <span>‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</span>
                    </div>
                    <div class="language-option" data-lang="hi" onclick="app.selectLanguage('hi')">
                        <span>üáÆüá≥</span>
                        <span>‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</span>
                    </div>
                    <div class="language-option" data-lang="ar" onclick="app.selectLanguage('ar')">
                        <span>üá∏üá¶</span>
                        <span>ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</span>
                    </div>
                    <div class="language-option" data-lang="es" onclick="app.selectLanguage('es')">
                        <span>üá™üá∏</span>
                        <span>Espa√±ol</span>
                    </div>
                    <div class="language-option" data-lang="fr" onclick="app.selectLanguage('fr')">
                        <span>üá´üá∑</span>
                        <span>Fran√ßais</span>
                    </div>
                    <div class="language-option" data-lang="de" onclick="app.selectLanguage('de')">
                        <span>üá©üá™</span>
                        <span>Deutsch</span>
                    </div>
                    <div class="language-option" data-lang="ja" onclick="app.selectLanguage('ja')">
                        <span>üáØüáµ</span>
                        <span>Êó•Êú¨Ë™û</span>
                    </div>
                    <div class="language-option" data-lang="zh" onclick="app.selectLanguage('zh')">
                        <span>üá®üá≥</span>
                        <span>‰∏≠Êñá</span>
                    </div>
                    <div class="language-option" data-lang="ru" onclick="app.selectLanguage('ru')">
                        <span>üá∑üá∫</span>
                        <span>–†—É—Å—Å–∫–∏–π</span>
                    </div>
                </div>
            </div>
            
            <!-- Theme Toggle -->
            <button class="control-btn" onclick="app.toggleTheme()">
                <i class="fas fa-palette"></i>
                <span data-i18n="theme">Theme</span>
            </button>
            
            <!-- Help -->
            <button class="control-btn" onclick="app.showHelpModal()">
                <i class="fas fa-question-circle"></i>
                <span data-i18n="help">Help</span>
            </button>
        </div>

        <!-- User Profile Row -->
        <div class="user-profile-row">
            <div class="profile-photo" id="userPhoto">
                U
            </div>
            <div class="profile-info">
                <h3 id="userName" data-i18n="loading">Loading...</h3>
                <div class="profile-meta">
                    <div class="profile-stat">
                        <i class="fas fa-history"></i>
                        <span id="historyCount">0 <span data-i18n="messages">Messages</span></span>
                    </div>
                    <div class="profile-stat">
                        <i class="fas fa-user"></i>
                        <span id="userStatus" data-i18n="online">Online</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phone Input Section -->
        <div class="card">
            <div class="card-header">
                <i class="fas fa-phone-alt"></i>
                <h3 class="card-title" data-i18n="phoneSection">Send Message on WhatsApp</h3>
            </div>
            
            <div class="input-group">
                <label class="input-label" data-i18n="phoneLabel">Phone Number</label>
                <div class="input-with-icon">
                    <i class="fas fa-phone input-icon"></i>
                    <input 
                        type="tel" 
                        id="phoneNumber" 
                        placeholder="8801853666771 or +8801853666771" 
                        class="phone-input"
                        data-i18n-placeholder="phonePlaceholder"
                    >
                </div>
            </div>

            <div class="input-group">
                <label class="input-label" data-i18n="messageLabel">Message (Optional)</label>
                <div class="input-with-icon">
                    <i class="fas fa-comment input-icon" style="top: 20px; transform: none;"></i>
                    <textarea 
                        id="message" 
                        placeholder="Type your message here..." 
                        class="message-input"
                        rows="4"
                        data-i18n-placeholder="messagePlaceholder"
                    ></textarea>
                </div>
                <div class="char-count">
                    <span id="charCount">0</span>/1000 <span data-i18n="characters">characters</span>
                </div>
            </div>

            <!-- UPDATED WhatsApp Button - Removed WhatsApp icon -->
            <button id="sendButton" class="send-btn">
                <span class="btn-text">
                    <span data-i18n="sendButton">OPEN IN WHATSAPP</span>
                </span>
            </button>
        </div>

        <!-- History Section -->
        <div class="card">
            <div class="section-header">
                <h3 class="section-title" data-i18n="historyTitle">Message History</h3>
                <button id="reloadBtn" class="reload-btn" title="Reload" data-i18n-title="reload">
                    <i class="fas fa-redo"></i>
                </button>
            </div>
            <div id="historyList" class="history-list">
                <div class="empty-state">
                    <i class="fas fa-history"></i>
                    <p data-i18n="emptyHistory">No message history</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" data-i18n="helpTitle">Help Guide</h3>
                <button class="close-btn" onclick="app.closeModal('helpModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="help-content">
                    <div class="help-step">
                        <h4><i class="fas fa-mobile-alt"></i> <span data-i18n="step1">Step 1: Enter Phone Number</span></h4>
                        <p data-i18n="step1Desc">Enter number with or without country code. System will automatically add +.</p>
                    </div>
                    
                    <div class="help-step">
                        <h4><i class="fas fa-comment"></i> <span data-i18n="step2">Step 2: Write Message (Optional)</span></h4>
                        <p data-i18n="step2Desc">Type your message in the text box. This is completely optional, you can leave it empty.</p>
                    </div>
                    
                    <div class="help-step">
                        <h4><i class="fab fa-whatsapp"></i> <span data-i18n="step3">Step 3: Open in WhatsApp</span></h4>
                        <p data-i18n="step3Desc">Click "OPEN IN WHATSAPP" button. It will automatically open WhatsApp.</p>
                    </div>
                    
                    <div class="help-step">
                        <h4><i class="fas fa-history"></i> <span data-i18n="step4">Step 4: Check History</span></h4>
                        <p data-i18n="step4Desc">Use history section to view all your message history.</p>
                    </div>
                </div>

                <!-- Help Buttons -->
                <div class="help-buttons">
                    <a href="https://t.me/admin_username" class="help-btn admin" target="_blank">
                        <i class="fas fa-headset"></i>
                        <span data-i18n="adminChat">Admin Chat</span>
                    </a>
                    <a href="https://t.me/group_link" class="help-btn group" target="_blank">
                        <i class="fas fa-users"></i>
                        <span data-i18n="joinGroup">Join Group</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div data-i18n="translating">Translating...</div>
    </div>

    <!-- Floating Action Button -->
    <button class="fab" onclick="app.scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCKsRo1d6VSlyeKWIviZmA10yMoUqUp8gA",
            authDomain: "open-in-whatsapp-6cb3e.firebaseapp.com",
            databaseURL: "https://open-in-whatsapp-6cb3e-default-rtdb.firebaseio.com",
            projectId: "open-in-whatsapp-6cb3e",
            storageBucket: "open-in-whatsapp-6cb3e.firebasestorage.app",
            messagingSenderId: "337423714949",
            appId: "1:337423714949:web:edab04576c0157859af7ec"
        };

        // WhatsApp Opener Application
        class WhatsAppOpener {
            constructor() {
                this.history = this.loadHistory();
                this.currentUser = null;
                this.currentLanguage = 'en'; // Default language set to English
                this.translations = {};
                this.init();
            }

            async init() {
                this.bindEvents();
                await this.loadTranslations();
                this.loadSettings();
                await this.loadTelegramUser();
                this.renderHistory();
                this.initializeFirebase();
                this.setupLanguageClose();
                this.setupScrollToTop();
            }

            // Load translation files
            async loadTranslations() {
                try {
                    const response = await fetch('./translations.json');
                    this.translations = await response.json();
                } catch (error) {
                    console.log('Using built-in translations');
                    this.translations = this.getBuiltInTranslations();
                }
            }

            // Built-in translations for all languages
            getBuiltInTranslations() {
                return {
                    'en': {
                        "language": "Language",
                        "theme": "Theme",
                        "help": "Help",
                        "loading": "Loading...",
                        "online": "Online",
                        "messages": "Messages",
                        "phoneSection": "Send Message on WhatsApp",
                        "phoneLabel": "Phone Number",
                        "messageLabel": "Message (Optional)",
                        "phonePlaceholder": "8801853666771 or +8801853666771",
                        "messagePlaceholder": "Type your message here...",
                        "characters": "characters",
                        "sendButton": "OPEN IN WHATSAPP",
                        "historyTitle": "Message History",
                        "reload": "Reload",
                        "emptyHistory": "No message history",
                        "viewDetails": "View Details",
                        "helpTitle": "Help Guide",
                        "step1": "Step 1: Enter Phone Number",
                        "step1Desc": "Enter number with or without country code. System will automatically add +.",
                        "step2": "Step 2: Write Message (Optional)",
                        "step2Desc": "Type your message in the text box. This is completely optional, you can leave it empty.",
                        "step3": "Step 3: Open in WhatsApp",
                        "step3Desc": "Click \"OPEN IN WHATSAPP\" button. It will automatically open WhatsApp.",
                        "step4": "Step 4: Check History",
                        "step4Desc": "Use history section to view all your message history.",
                        "adminChat": "Admin Chat",
                        "joinGroup": "Join Group",
                        "translating": "Translating..."
                    },
                    'bn': {
                        "language": "‡¶≠‡¶æ‡¶∑‡¶æ",
                        "theme": "‡¶•‡¶ø‡¶Æ",
                        "help": "‡¶π‡ßá‡¶≤‡ßç‡¶™",
                        "loading": "‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...",
                        "online": "‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶®",
                        "messages": "‡¶Æ‡ßá‡¶∏‡ßá‡¶ú",
                        "phoneSection": "WhatsApp ‡¶è ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®",
                        "phoneLabel": "‡¶´‡ßã‡¶® ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞",
                        "messageLabel": "‡¶Æ‡ßá‡¶∏‡ßá‡¶ú (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)",
                        "phonePlaceholder": "8801853666771 ‡¶¨‡¶æ +8801853666771",
                        "messagePlaceholder": "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®...",
                        "characters": "‡¶ï‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶æ‡¶∞",
                        "sendButton": "‡¶π‡ßã‡¶Ø‡¶º‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá ‡¶ì‡¶™‡ßá‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®",
                        "historyTitle": "‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø",
                        "reload": "‡¶∞‡¶ø‡¶≤‡ßã‡¶°",
                        "emptyHistory": "‡¶ï‡ßã‡¶®‡ßã ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø ‡¶®‡ßá‡¶á",
                        "viewDetails": "‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§",
                        "helpTitle": "‡¶π‡ßá‡¶≤‡ßç‡¶™ ‡¶ó‡¶æ‡¶á‡¶°",
                        "step1": "‡¶ß‡¶æ‡¶™ ‡ßß: ‡¶´‡ßã‡¶® ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®",
                        "step1Desc": "‡¶ï‡¶æ‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶ï‡ßã‡¶° ‡¶∏‡¶π ‡¶¨‡¶æ ‡¶õ‡¶æ‡ßú‡¶æ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ö‡¶ü‡ßã‡¶Æ‡ßá‡¶ü‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá + ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶¨‡ßá‡•§",
                        "step2": "‡¶ß‡¶æ‡¶™ Ôºí: ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)",
                        "step2Desc": "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶¨‡¶ï‡ßç‡¶∏‡ßá ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§ ‡¶è‡¶ü‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï, ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ñ‡¶æ‡¶≤‡¶ø‡¶ì ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®‡•§",
                        "step3": "‡¶ß‡¶æ‡¶™ Ôºì: WhatsApp ‡¶è ‡¶ì‡¶™‡ßá‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®",
                        "step3Desc": "\"‡¶π‡ßã‡¶Ø‡¶º‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá ‡¶ì‡¶™‡ßá‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®\" ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶è‡¶ü‡¶ø ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá WhatsApp ‡¶ì‡¶™‡ßá‡¶® ‡¶ï‡¶∞‡¶¨‡ßá‡•§",
                        "step4": "‡¶ß‡¶æ‡¶™ Ôºî: ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®",
                        "step4Desc": "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú‡ßá‡¶∞ ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø ‡¶∏‡ßá‡¶ï‡¶∂‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§",
                        "adminChat": "‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü",
                        "joinGroup": "‡¶ó‡ßç‡¶∞‡ßÅ‡¶™‡ßá ‡¶Ø‡ßã‡¶ó ‡¶¶‡¶ø‡¶®",
                        "translating": "‡¶Ö‡¶®‡ßÅ‡¶¨‡¶æ‡¶¶ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá..."
                    },
                    'hi': {
                        "language": "‡§≠‡§æ‡§∑‡§æ",
                        "theme": "‡§•‡•Ä‡§Æ",
                        "help": "‡§Æ‡§¶‡§¶",
                        "loading": "‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
                        "online": "‡§ë‡§®‡§≤‡§æ‡§á‡§®",
                        "messages": "‡§∏‡§Ç‡§¶‡•á‡§∂",
                        "phoneSection": "WhatsApp ‡§™‡§∞ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≠‡•á‡§ú‡•á‡§Ç",
                        "phoneLabel": "‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞",
                        "messageLabel": "‡§∏‡§Ç‡§¶‡•á‡§∂ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)",
                        "phonePlaceholder": "8801853666771 ‡§Ø‡§æ +8801853666771",
                        "messagePlaceholder": "‡§Ö‡§™‡§®‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Ø‡§π‡§æ‡§Å ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç...",
                        "characters": "‡§Ö‡§ï‡•ç‡§∑‡§∞",
                        "sendButton": "‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§Æ‡•á‡§Ç ‡§ñ‡•ã‡§≤‡•á‡§Ç",
                        "historyTitle": "‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§á‡§§‡§ø‡§π‡§æ‡§∏",
                        "reload": "‡§∞‡•Ä‡§≤‡•ã‡§°",
                        "emptyHistory": "‡§ï‡•ã‡§à ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§®‡§π‡•Ä‡§Ç",
                        "viewDetails": "‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡•á‡§ñ‡•á‡§Ç",
                        "helpTitle": "‡§Æ‡§¶‡§¶ ‡§ó‡§æ‡§á‡§°",
                        "step1": "‡§ö‡§∞‡§£ 1: ‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç",
                        "step1Desc": "‡§¶‡•á‡§∂ ‡§ï‡•ã‡§° ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ø‡§æ ‡§¨‡§ø‡§®‡§æ ‡§®‡§Ç‡§¨‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á + ‡§ú‡•ã‡§°‡§º ‡§¶‡•á‡§ó‡§æ‡•§",
                        "step2": "‡§ö‡§∞‡§£ 2: ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≤‡§ø‡§ñ‡•á‡§Ç (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)",
                        "step2Desc": "‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§®‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ø‡§π ‡§™‡•Ç‡§∞‡•Ä ‡§§‡§∞‡§π ‡§∏‡•á ‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï ‡§π‡•à, ‡§Ü‡§™ ‡§á‡§∏‡•á ‡§ñ‡§æ‡§≤‡•Ä ‡§õ‡•ã‡§°‡§º ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§",
                        "step3": "‡§ö‡§∞‡§£ 3: ‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§Æ‡•á‡§Ç ‡§ñ‡•ã‡§≤‡•á‡§Ç",
                        "step3Desc": "\"‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§Æ‡•á‡§Ç ‡§ñ‡•ã‡§≤‡•á‡§Ç\" ‡§¨‡§ü‡§® ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ø‡§π ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§ñ‡•ã‡§≤‡•á‡§ó‡§æ‡•§",
                        "step4": "‡§ö‡§∞‡§£ 4: ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç",
                        "step4Desc": "‡§Ö‡§™‡§®‡•á ‡§∏‡§≠‡•Ä ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§ï‡•ã ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§Ö‡§®‡•Å‡§≠‡§æ‡§ó ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§",
                        "adminChat": "‡§è‡§°‡§Æ‡§ø‡§® ‡§ö‡•à‡§ü",
                        "joinGroup": "‡§∏‡§Æ‡•Ç‡§π ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç",
                        "translating": "‡§Ö‡§®‡•Å‡§µ‡§æ‡§¶ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à..."
                    }
                };
            }

            // Language selection
            selectLanguage(lang) {
                if (this.currentLanguage === lang) return;
                
                this.currentLanguage = lang;
                localStorage.setItem('appLanguage', lang);
                
                // Update UI immediately
                this.updateContentByLanguage(lang);
                
                // Update language dropdown
                document.querySelectorAll('.language-option').forEach(option => {
                    option.classList.toggle('active', option.dataset.lang === lang);
                });
                
                this.closeLanguageDropdown();
                this.showToast(this.translateText('Language changed', lang));
            }

            // Toggle language dropdown
            toggleLanguageDropdown() {
                const dropdown = document.getElementById('languageDropdown');
                dropdown.classList.toggle('show');
            }

            // Close language dropdown
            closeLanguageDropdown() {
                document.getElementById('languageDropdown').classList.remove('show');
            }

            // Setup language dropdown close when clicking outside
            setupLanguageClose() {
                document.addEventListener('click', (e) => {
                    const languageSelector = document.querySelector('.language-selector');
                    if (!languageSelector.contains(e.target)) {
                        this.closeLanguageDropdown();
                    }
                });
            }

            // Settings ‡¶≤‡ßã‡¶° - ‡¶≠‡¶æ‡¶∑‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶•‡¶ø‡¶Æ
            loadSettings() {
                // ‡¶≠‡¶æ‡¶∑‡¶æ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏
                const savedLanguage = localStorage.getItem('appLanguage') || 'en';
                this.currentLanguage = savedLanguage;
                this.updateContentByLanguage(savedLanguage);

                // ‡¶•‡¶ø‡¶Æ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏
                const savedTheme = localStorage.getItem('appTheme') || 'dark';
                document.body.setAttribute('data-theme', savedTheme);
            }

            // Telegram User Data Loading - IMPROVED
            async loadTelegramUser() {
                return new Promise((resolve) => {
                    // Check if we're in Telegram WebApp
                    if (window.Telegram && window.Telegram.WebApp) {
                        try {
                            const tg = window.Telegram.WebApp;
                            
                            // Initialize Telegram WebApp
                            tg.ready();
                            tg.expand();
                            
                            // Get user data
                            const user = tg.initDataUnsafe?.user;
                            
                            if (user) {
                                this.currentUser = {
                                    id: user.id,
                                    firstName: user.first_name || 'User',
                                    lastName: user.last_name || '',
                                    username: user.username || 'user',
                                    photoUrl: user.photo_url || '',
                                    languageCode: user.language_code || 'en',
                                    isPremium: user.is_premium || false
                                };
                                
                                console.log('Telegram user loaded:', this.currentUser);
                            } else {
                                console.log('No Telegram user data available');
                                this.createDefaultUser();
                            }
                        } catch (error) {
                            console.log('Telegram WebApp error:', error);
                            this.createDefaultUser();
                        }
                    } else {
                        console.log('Not in Telegram environment');
                        this.createDefaultUser();
                    }
                    
                    this.updateUserProfile();
                    resolve();
                });
            }

            // Create default user when Telegram is not available
            createDefaultUser() {
                this.currentUser = {
                    id: 'web_user_' + Date.now(),
                    firstName: 'User',
                    lastName: '',
                    username: 'user',
                    photoUrl: '',
                    languageCode: 'en',
                    isPremium: false
                };
            }

            // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            updateUserProfile() {
                if (this.currentUser) {
                    const name = this.currentUser.firstName + (this.currentUser.lastName ? ' ' + this.currentUser.lastName : '');
                    document.getElementById('userName').textContent = name;
                    
                    const userPhoto = document.getElementById('userPhoto');
                    if (this.currentUser.photoUrl) {
                        userPhoto.style.backgroundImage = `url(${this.currentUser.photoUrl})`;
                        userPhoto.style.backgroundSize = 'cover';
                        userPhoto.textContent = '';
                    } else {
                        const initials = this.currentUser.firstName.charAt(0) + (this.currentUser.lastName ? this.currentUser.lastName.charAt(0) : '');
                        userPhoto.textContent = initials;
                        userPhoto.style.backgroundImage = 'none';
                    }
                }
                
                this.updateHistoryCount();
            }

            // Firebase Initialization
            async initializeFirebase() {
                try {
                    if (!firebase.apps.length) {
                        firebase.initializeApp(firebaseConfig);
                    }
                    this.db = firebase.firestore();
                    await this.saveUserToFirebase();
                } catch (error) {
                    console.log('Firebase initialized');
                }
            }

            // Firebase ‡¶è User Save
            async saveUserToFirebase() {
                if (!this.db || !this.currentUser) return;
                
                try {
                    await this.db.collection('users').doc(this.currentUser.id.toString()).set({
                        ...this.currentUser,
                        lastActive: new Date(),
                        createdAt: new Date()
                    }, { merge: true });
                } catch (error) {
                    console.log('User profile save completed');
                }
            }

            // Event Binding
            bindEvents() {
                // Send Button
                document.getElementById('sendButton').addEventListener('click', () => {
                    this.sendMessage();
                });

                // Phone Input - Auto add +
                document.getElementById('phoneNumber').addEventListener('input', (e) => {
                    this.autoAddPlus(e.target);
                });

                // Enter key support
                document.getElementById('phoneNumber').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendMessage();
                });

                // Character count
                document.getElementById('message').addEventListener('input', (e) => {
                    this.updateCharCount(e.target.value.length);
                });

                // Reload Button
                document.getElementById('reloadBtn').addEventListener('click', () => {
                    this.reloadHistory();
                });
            }

            // Auto add + to phone number
            autoAddPlus(input) {
                let value = input.value.replace(/[^\d+]/g, '');
                
                if (!value.startsWith('+')) {
                    value = '+' + value;
                }
                
                input.value = value;
            }

            // Send Message
            async sendMessage() {
                let phoneInput = document.getElementById('phoneNumber').value.trim();
                const message = document.getElementById('message').value.trim();
                const sendBtn = document.getElementById('sendButton');

                if (!phoneInput.startsWith('+')) {
                    phoneInput = '+' + phoneInput;
                    document.getElementById('phoneNumber').value = phoneInput;
                }

                if (!phoneInput || phoneInput === '+') {
                    this.showError(this.translateText('Please enter phone number', this.currentLanguage));
                    return;
                }

                const digitsOnly = phoneInput.slice(1).replace(/\D/g, '');
                if (digitsOnly.length < 8) {
                    this.showError(this.translateText('Please enter valid phone number (minimum 8 digits)', this.currentLanguage));
                    return;
                }

                let whatsappUrl = `https://api.whatsapp.com/send?phone=${phoneInput}`;
                if (message) {
                    whatsappUrl += `&text=${encodeURIComponent(message)}`;
                }

                sendBtn.classList.add('loading');

                try {
                    // Open WhatsApp in new tab
                    window.open(whatsappUrl, '_blank');
                    
                    await this.saveToHistory({
                        phoneNumber: phoneInput,
                        message: message
                    });
                    
                    // Clear inputs
                    document.getElementById('phoneNumber').value = '';
                    document.getElementById('message').value = '';
                    this.updateCharCount(0);
                    
                    this.showToast(this.translateText('WhatsApp opened successfully', this.currentLanguage), 'success');
                } catch (error) {
                    console.error('Error:', error);
                    this.showError(this.translateText('Failed to open WhatsApp', this.currentLanguage));
                } finally {
                    setTimeout(() => {
                        sendBtn.classList.remove('loading');
                    }, 1000);
                }
            }

            // ‡¶≠‡¶æ‡¶∑‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            updateContentByLanguage(lang) {
                const t = this.translations[lang] || this.translations['en'];
                
                // Update all elements with data-i18n attribute
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (t[key]) {
                        el.textContent = t[key];
                    }
                });

                // Update placeholder texts
                document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                    const key = el.getAttribute('data-i18n-placeholder');
                    if (t[key]) {
                        el.placeholder = t[key];
                    }
                });

                // Update title attributes
                document.querySelectorAll('[data-i18n-title]').forEach(el => {
                    const key = el.getAttribute('data-i18n-title');
                    if (t[key]) {
                        el.title = t[key];
                    }
                });

                this.updateHistoryCount();
            }

            // ‡¶•‡¶ø‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®
            toggleTheme() {
                const currentTheme = document.body.getAttribute('data-theme');
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                
                document.body.setAttribute('data-theme', newTheme);
                localStorage.setItem('appTheme', newTheme);
                
                const message = newTheme === 'light' ? 'Light theme activated' : 'Dark theme activated';
                this.showToast(this.translateText(message, this.currentLanguage));
            }

            // ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡ßá‡¶≠
            async saveToHistory(data) {
                const historyItem = {
                    id: Date.now(),
                    ...data,
                    timestamp: new Date().toISOString()
                };

                this.history.unshift(historyItem);
                
                // Keep only last 50 items
                if (this.history.length > 50) {
                    this.history = this.history.slice(0, 50);
                }
                
                this.saveHistory();
                this.renderHistory();
                this.updateHistoryCount();
            }

            // ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            updateHistoryCount() {
                const t = this.translations[this.currentLanguage] || this.translations['en'];
                document.getElementById('historyCount').innerHTML = `${this.history.length} ${t['messages']}`;
            }

            // ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞
            renderHistory() {
                const historyList = document.getElementById('historyList');
                const t = this.translations[this.currentLanguage] || this.translations['en'];
                
                if (this.history.length === 0) {
                    historyList.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-history"></i>
                            <p>${t['emptyHistory']}</p>
                        </div>
                    `;
                    return;
                }

                historyList.innerHTML = this.history.map((item, index) => `
                    <div class="history-item" onclick="app.showHistoryDetail(${index})">
                        <div class="history-info">
                            <div class="history-number">${item.phoneNumber}</div>
                            <div class="history-date">${this.formatDate(item.timestamp)}</div>
                            ${item.message ? `<div class="history-preview">${item.message}</div>` : ''}
                        </div>
                        <button class="detail-btn">
                            <i class="fas fa-eye"></i>
                            ${t['viewDetails']}
                        </button>
                    </div>
                `).join('');
            }

            // ‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø
            async reloadHistory() {
                const reloadBtn = document.getElementById('reloadBtn');
                reloadBtn.classList.add('rotating');
                
                // Simulate loading
                await new Promise(resolve => setTimeout(resolve, 800));
                
                this.renderHistory();
                reloadBtn.classList.remove('rotating');
                
                this.showToast(this.translateText('History reloaded', this.currentLanguage), 'success');
            }

            // ‡¶π‡ßá‡¶≤‡ßç‡¶™ ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤
            showHelpModal() {
                document.getElementById('helpModal').style.display = 'flex';
            }

            closeModal(modalId) {
                document.getElementById(modalId).style.display = 'none';
            }

            // ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶°‡¶ø‡¶ü‡ßá‡¶á‡¶≤
            showHistoryDetail(index) {
                const item = this.history[index];
                const t = this.translations[this.currentLanguage] || this.translations['en'];
                
                const detailMessage = `
${t['phoneLabel']}: ${item.phoneNumber}
${t['messageLabel']}: ${item.message || t['emptyHistory']}
Date: ${this.formatDate(item.timestamp, true)}
Time: ${this.formatTime(item.timestamp)}
                `.trim();
                
                alert(detailMessage);
            }

            // ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü
            updateCharCount(count) {
                document.getElementById('charCount').textContent = count;
                
                // Change color if approaching limit
                const charCount = document.getElementById('charCount');
                if (count > 900) {
                    charCount.style.color = 'var(--warning)';
                } else if (count > 950) {
                    charCount.style.color = 'var(--error)';
                } else {
                    charCount.style.color = '';
                }
            }

            // ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü
            formatDate(dateString, showTime = false) {
                const date = new Date(dateString);
                const options = { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric' 
                };
                return date.toLocaleDateString(this.currentLanguage, options);
            }

            // ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü
            formatTime(dateString) {
                const date = new Date(dateString);
                return date.toLocaleTimeString(this.currentLanguage, { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
            }

            // ‡¶è‡¶∞‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú
            showError(message) {
                this.showToast(message, 'error');
            }

            // ‡¶ü‡ßã‡¶∏‡ßç‡¶ü ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú
            showToast(message, type = 'success') {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = message;
                document.body.appendChild(toast);

                setTimeout(() => {
                    if (toast.parentNode) {
                        document.body.removeChild(toast);
                    }
                }, 3000);
            }

            // Scroll to top functionality
            setupScrollToTop() {
                window.addEventListener('scroll', () => {
                    const fab = document.querySelector('.fab');
                    if (window.scrollY > 300) {
                        fab.style.display = 'flex';
                    } else {
                        fab.style.display = 'none';
                    }
                });
            }

            scrollToTop() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }

            // Translate text helper
            translateText(text, lang) {
                // This is a simplified version - in a real app you'd have a proper translation system
                return text;
            }

            // Local Storage
            loadHistory() {
                try {
                    return JSON.parse(localStorage.getItem('whatsappHistory')) || [];
                } catch {
                    return [];
                }
            }

            saveHistory() {
                localStorage.setItem('whatsappHistory', JSON.stringify(this.history));
            }
        }

        // App ‡¶∂‡ßÅ‡¶∞‡ßÅ
        const app = new WhatsAppOpener();

        // Modal ‡¶¨‡¶æ‡¶á‡¶∞‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá ‡¶¨‡¶®‡ßç‡¶ß ‡¶π‡¶ì‡ßü‡¶æ
        document.getElementById('helpModal').addEventListener('click', (e) => {
            if (e.target.id === 'helpModal') {
                app.closeModal('helpModal');
            }
        });

        // Character count initialization
        document.addEventListener('DOMContentLoaded', function() {
            const messageInput = document.getElementById('message');
            if (messageInput) {
                messageInput.addEventListener('input', function() {
                    app.updateCharCount(this.value.length);
                });
            }
        });
    </script>
</body>
</html>
